/* 
 * Boxer v1.10.2 - 2013-12-17 
 * A jQuery plugin for displaying images and content in a modal overlay. Part of the formstone library. 
 * http://www.benplum.com/formstone/boxer/ 
 * 
 * Copyright 2013 Ben Plum; MIT Licensed 
 */ 

!function(a,b){"use strict";function c(b){return D.formatter=k,a(this).on("click.boxer",a.extend({},D,b||{}),d)}function d(c){C(c);var d=a(this),e=c.data.$object,f=d[0].attributes?d.attr("href")||"":"",k=f.toLowerCase().split("."),l=k[k.length-1],m=d.data("type")||"",n="image"===m||"jpeg"===l||"jpg"===l||"gif"===l||"png"===l||"data:image"===f.substr(0,10),o=f.indexOf("youtube.com/embed")>-1||f.indexOf("player.vimeo.com/video")>-1,v="url"===m||!n&&!o&&"http"===f.substr(0,4),w="element"===m||!n&&!o&&!v&&"#"===f.substr(0,1),x="undefined"!=typeof e;if(a("#boxer").length<1&&(n||o||v||w||x)){if(E={$window:a(b),$body:a("body"),$target:d,$object:e,visible:!1,resizeTimer:null,touchTimer:null,gallery:{active:!1},options:c.data,isMobile:(F||c.data.mobile)&&!w},E.type=n?"image":o?"video":"element",n||o){var y=E.$target.attr("rel");"undefined"!=typeof y&&y!==!1&&(E.gallery.active=!0,E.gallery.rel=y,E.gallery.$items=a("a[rel= "+E.gallery.rel+"]"),E.gallery.index=E.gallery.$items.index(E.$target),E.gallery.total=E.gallery.$items.length-1)}var z="";E.isMobile||(z+='<div id="boxer-overlay" class="'+E.options.customClass+'" style="opacity: 0"></div>'),z+='<div id="boxer" class="loading '+E.options.customClass,E.isMobile&&(z+=" mobile"),v&&(z+=" iframe"),(w||x)&&(z+=" inline"),z+='" style="opacity: 0;',E.options.fixed===!0&&(z+=" position: fixed;"),z+='">',z+='<span class="boxer-close">'+E.options.labels.close+"</span>",z+='<div class="boxer-container" style="',z+=E.isMobile?"height: 100%; width: 100%":"height: "+E.options.height+"px; width: "+E.options.width+"px",z+='">',z+='<div class="boxer-content" style="opacity: 0;">',(n||o)&&(z+='<div class="boxer-meta">',E.gallery.active?(z+='<div class="boxer-arrow previous">'+E.options.labels.previous+"</div>",z+='<div class="boxer-arrow next">'+E.options.labels.next+"</div>",z+='<p class="boxer-position"',E.gallery.total<1&&(z+=' style="display: none;"'),z+=">",z+='<span class="current">'+(E.gallery.index+1)+"</span> "+E.options.labels.count+' <span class="total">'+(E.gallery.total+1)+"</span>",z+="</p>",z+='<div class="boxer-caption gallery">'):z+='<div class="boxer-caption">',z+=E.options.formatter.apply(E.$body,[E.$target]),z+="</div></div>"),z+="</div></div></div>",E.$body.append(z),E.$overlay=a("#boxer-overlay"),E.$boxer=a("#boxer"),E.$container=E.$boxer.find(".boxer-container"),E.$content=E.$boxer.find(".boxer-content"),E.$meta=E.$boxer.find(".boxer-meta"),E.$position=E.$boxer.find(".boxer-position"),E.$caption=E.$boxer.find(".boxer-caption"),E.$arrows=E.$boxer.find(".boxer-arrow"),E.$animatables=a("#boxer-overlay, #boxer, .boxer-container"),E.paddingVertical=parseInt(E.$boxer.css("paddingTop"),10)+parseInt(E.$boxer.css("paddingBottom"),10),E.paddingHorizontal=parseInt(E.$boxer.css("paddingLeft"),10)+parseInt(E.$boxer.css("paddingRight"),10),h(),E.gallery.active&&q(),E.$window.on("resize.boxer",G.resize).on("keydown.boxer",r),E.$body.on("touchstart.boxer click.boxer","#boxer-overlay, #boxer .boxer-close",g).on("touchmove.boxer",C),E.gallery.active&&E.$boxer.on("touchstart.boxer click.boxer",".boxer-arrow",p),E.$overlay.stop().animate({opacity:E.options.opacity},E.options.duration),E.$boxer.stop().animate({opacity:1},E.options.duration,function(){n?i(f):o?j(f):v?t(f):w?s(f):x?u(E.$object):a.error("BOXER: '"+f+"' is not valid.")})}return x?E.$boxer:void 0}function e(){var a=0,b=0,c=0,d=E.isMobile?0:E.options.duration;E.isMobile||(a=(E.$window.width()-E.contentWidth-E.paddingHorizontal)/2,b=E.options.top<=0?(E.$window.height()-E.contentHeight-E.paddingVertical)/2:E.options.top,c=E.$arrows.outerHeight(),E.options.fixed!==!0&&(b+=E.$window.scrollTop()),E.$arrows.css({marginTop:(E.contentHeight-E.metaHeight-c)/2})),!E.visible&&E.isMobile&&E.gallery.active&&E.$content.on("touchstart.boxer",".boxer-image",w),(E.isMobile||E.options.fixed)&&E.$body.addClass("boxer-open"),E.$boxer.stop().animate({left:a,top:b},d),E.$container.show().stop().animate({height:E.containerHeight,width:E.containerWidth},d,function(){E.$content.stop().animate({opacity:1},E.options.duration),E.$boxer.removeClass("loading").find(".boxer-close").stop().animate({opacity:1},E.options.duration),E.visible=!0,E.options.callback.apply(E.$boxer),E.$window.trigger("boxer.open"),E.gallery.active&&o()})}function f(a){if(a=a||!1,E.visible){var b=0,c=0,d=0;E.isMobile||(b=(E.$window.width()-E.contentWidth-E.paddingHorizontal)/2,c=E.options.top<=0?(E.$window.height()-E.contentHeight-E.paddingVertical)/2:E.options.top,d=E.$arrows.outerHeight(),E.options.fixed!==!0&&(c+=E.$window.scrollTop()),E.$arrows.css({marginTop:(E.contentHeight-E.metaHeight-d)/2})),a?(E.$boxer.stop().animate({left:b,top:c},E.options.duration),E.$container.show().stop().animate({height:E.containerHeight,width:E.containerWidth})):(E.$boxer.css({left:b,top:c}),E.$container.css({height:E.containerHeight,width:E.containerWidth}))}}function g(b){C(b),"undefined"!=typeof E.$animatables&&(E.$animatables.stop().animate({opacity:0},E.options.duration,function(){a(this).remove()}),A(E.resizeTimer),E.$window.off(".boxer"),E.$body.off(".boxer").removeClass("boxer-open"),E.gallery.active&&E.$boxer.off(".boxer"),E.isMobile&&"image"===E.type&&E.gallery.active&&E.$container.off(".boxer"),E.$window.trigger("boxer.close"),E={})}function h(){var a=0,b=0;E.isMobile||(a=(E.$window.width()-E.$boxer.width()-E.paddingHorizontal)/2,b=E.options.top<=0?(E.$window.height()-E.$boxer.height()-E.paddingVertical)/2:E.options.top,E.options.fixed!==!0&&(b+=E.$window.scrollTop())),E.$boxer.css({left:a,top:b})}function i(b){E.$image=a("<img />"),E.$image.one("load.boxer",function(){var a=B(E.$image);E.naturalHeight=a.naturalHeight,E.naturalWidth=a.naturalWidth,E.options.retina&&(E.naturalHeight/=2,E.naturalWidth/=2),E.$content.prepend(E.$image),""===E.$caption.html()?E.$caption.hide():E.$caption.show(),l(0)&&e()}).attr("src",b).addClass("boxer-image"),(E.$image[0].complete||4===E.$image[0].readyState)&&E.$image.trigger("load")}function j(b){E.$videoWrapper=a('<div class="boxer-video-wrapper" />'),E.$video=a('<iframe class="boxer-video" />'),E.$video.attr("src",b).addClass("boxer-video").prependTo(E.$videoWrapper),E.$content.prepend(E.$videoWrapper),n(),e()}function k(a){var b=a.attr("title");return""!==b&&void 0!==b?'<p class="caption">'+b+"</p>":""}function l(a){return E.windowHeight=E.viewportHeight=0===a?E.$window.height():E.windowHeight,E.windowWidth=E.viewportWidth=0===a?E.$window.width():E.windowWidth,E.imageHeight=0===a?E.naturalHeight:E.$image.outerHeight(),E.imageWidth=0===a?E.naturalWidth:E.$image.outerWidth(),E.metaHeight=0===a?0:E.metaHeight,0===a&&(E.ratioHorizontal=E.imageHeight/E.imageWidth,E.ratioVertical=E.imageWidth/E.imageHeight,E.isWide=E.imageWidth>E.imageHeight),E.imageHeight<E.options.minHeight&&(E.options.minHeight=E.imageHeight),E.imageWidth<E.options.minWidth&&(E.options.minWidth=E.imageWidth),E.isMobile?(E.containerHeight=E.viewportHeight-E.paddingVertical,E.containerWidth=E.viewportWidth-E.paddingHorizontal,E.contentHeight=E.containerHeight-E.metaHeight,E.contentWidth=E.containerWidth,E=m(E),E.imageMarginTop=(E.contentHeight-E.targetImageHeight)/2,E.imageMarginLeft=(E.contentWidth-E.targetImageWidth)/2):(E.viewportHeight-=E.options.margin+E.paddingVertical+E.metaHeight,E.viewportWidth-=E.options.margin+E.paddingHorizontal,E=m(E),E.containerHeight=E.contentHeight=E.targetImageHeight,E.containerWidth=E.contentWidth=E.targetImageWidth,E.imageMarginTop=0,E.imageMarginLeft=0),E.$content.css({height:E.isMobile?E.contentHeight:"auto",width:E.contentWidth}),E.$meta.css({width:E.contentWidth}),E.$image.css({height:E.targetImageHeight,width:E.targetImageWidth,marginTop:E.imageMarginTop,marginLeft:E.imageMarginLeft}),E.metaHeight=E.$meta.outerHeight(!0),E.contentHeight+=E.metaHeight,E.isMobile||(E.containerHeight+=E.metaHeight),E.contentHeight>E.viewportHeight&&2>a?l(a+1):!0}function m(a){var b=a.isMobile?a.contentHeight-a.options.margin:a.viewportHeight,c=a.isMobile?a.contentWidth-a.options.margin:a.viewportWidth;return a.isWide?(a.targetImageWidth=c,a.targetImageHeight=a.targetImageWidth*a.ratioHorizontal,a.targetImageHeight>b&&(a.targetImageHeight=b,a.targetImageWidth=a.targetImageHeight*a.ratioVertical)):(a.targetImageHeight=b,a.targetImageWidth=a.targetImageHeight*a.ratioVertical,a.targetImageWidth>c&&(a.targetImageWidth=c,a.targetImageHeight=a.targetImageWidth*a.ratioHorizontal)),(a.targetImageWidth>a.imageWidth||a.targetImageHeight>a.imageHeight)&&(a.targetImageWidth=a.imageWidth,a.targetImageHeight=a.imageHeight),(a.targetImageWidth<a.options.minWidth||a.targetImageHeight<a.options.minHeight)&&(a.targetImageWidth<a.options.minWidth?(a.targetImageWidth=a.options.minWidth,a.targetImageHeight=a.targetImageWidth*a.ratioHorizontal):(a.targetImageHeight=a.options.minHeight,a.targetImageWidth=a.targetImageHeight*a.ratioVertical)),a}function n(){E.windowHeight=E.$window.height()-E.paddingVertical,E.windowWidth=E.$window.width()-E.paddingHorizontal,E.videoMarginTop=0,E.videoMarginLeft=0,E.isMobile?(E.$meta.css({width:E.windowWidth}),E.metaHeight=E.$meta.outerHeight(!0),E.contentHeight=E.windowHeight,E.contentWidth=E.windowWidth,E.videoWidth=E.windowWidth,E.videoHeight=E.videoWidth*E.options.videoRatio,E.videoHeight>E.windowHeight-E.metaHeight&&(E.videoHeight=E.windowHeight-E.metaHeight,E.videoWidth=E.videoHeight*E.options.videoRatio),E.videoMarginTop=(E.contentHeight-E.videoHeight)/2,E.videoMarginLeft=(E.contentWidth-E.videoWidth)/2):(E.windowHeight-=E.options.margin,E.windowWidth-=E.options.margin,E.videoWidth=E.options.videoWidth>E.windowWidth?E.windowWidth:E.options.videoWidth,E.videoHeight=E.videoWidth*E.options.videoRatio,E.contentHeight=E.videoHeight,E.contentWidth=E.videoWidth),E.$content.css({height:E.isMobile?E.contentHeight:"auto",width:E.contentWidth}),E.$meta.css({width:E.contentWidth}),E.$videoWrapper.css({height:E.videoHeight,width:E.videoWidth,marginTop:E.videoMarginTop,marginLeft:E.videoMarginLeft}),E.isMobile||(E.metaHeight=E.$meta.outerHeight(!0),E.contentHeight=E.videoHeight+E.metaHeight),E.containerHeight=E.contentHeight,E.containerWidth=E.contentWidth=E.videoWidth}function o(){var b="";E.gallery.index>0&&(b=E.gallery.$items.eq(E.gallery.index-1).attr("href"),b.indexOf("youtube.com/embed")<0&&b.indexOf("player.vimeo.com/video")<0&&a('<img src="'+b+'">')),E.gallery.index<E.gallery.total&&(b=E.gallery.$items.eq(E.gallery.index+1).attr("href"),b.indexOf("youtube.com/embed")<0&&b.indexOf("player.vimeo.com/video")<0&&a('<img src="'+b+'">'))}function p(b){C(b);var c=a(this);c.hasClass("disabled")||(E.$boxer.addClass("loading"),E.gallery.index+=c.hasClass("next")?1:-1,E.gallery.index>E.gallery.total&&(E.gallery.index=E.gallery.total),E.gallery.index<0&&(E.gallery.index=0),E.$content.stop().animate({opacity:0},E.options.duration,function(){"undefined"!=typeof E.$image&&E.$image.remove(),"undefined"!=typeof E.$videoWrapper&&E.$videoWrapper.remove(),E.$target=E.gallery.$items.eq(E.gallery.index),E.$caption.html(E.options.formatter.apply(E.$body,[E.$target])),E.$position.find(".current").html(E.gallery.index+1);var a=E.$target.attr("href"),b=a.indexOf("youtube.com/embed")>-1||a.indexOf("player.vimeo.com/video")>-1;b?j(a):i(a),q()}))}function q(){E.$arrows.removeClass("disabled"),0===E.gallery.index&&E.$arrows.filter(".previous").addClass("disabled"),E.gallery.index===E.gallery.total&&E.$arrows.filter(".next").addClass("disabled")}function r(a){!E.gallery.active||37!==a.keyCode&&39!==a.keyCode?27===a.keyCode&&E.$boxer.find(".boxer-close").trigger("click"):(C(a),E.$arrows.filter(37===a.keyCode?".previous":".next").trigger("click"))}function s(b){var c=a(b).find(">:first-child").clone();u(c)}function t(b){b+=b.indexOf("?")>-1?"&"+D.requestKey+"=true":"?"+D.requestKey+"=true";var c=a('<iframe class="boxer-iframe" src="'+b+'" />');u(c)}function u(a){E.$content.append(a),v(a),e()}function v(a){E.objectHeight=a.outerHeight(!0),E.objectWidth=a.outerWidth(!0),E.windowHeight=E.$window.height()-E.paddingVertical,E.windowWidth=E.$window.width()-E.paddingHorizontal,E.dataHeight=E.$target.data("height"),E.dataWidth=E.$target.data("width"),E.maxHeight=E.windowHeight<0?D.minHeight:E.windowHeight,E.isIframe=a.is("iframe"),E.objectMarginTop=0,E.objectMarginLeft=0,E.isMobile||(E.windowHeight-=E.options.margin,E.windowWidth-=E.options.margin),E.contentHeight=void 0!==E.dataHeight?E.dataHeight:E.isIframe?E.windowHeight:E.objectHeight,E.contentWidth=void 0!==E.dataWidth?E.dataWidth:E.isIframe?E.windowWidth:E.objectWidth,E.isIframe&&E.isMobile&&(E.contentHeight=E.windowHeight,E.contentWidth=E.windowWidth),E.containerHeight=E.contentHeight,E.containerWidth=E.contentWidth,E.$content.css({height:E.contentHeight,width:E.contentWidth})}function w(a){if(C(a),A(E.touchTimer),!E.isAnimating){var b="undefined"!=typeof a.originalEvent.targetTouches?a.originalEvent.targetTouches[0]:null;E.xStart=b?b.pageX:a.clientX,E.leftPosition=0,E.touchMax=1/0,E.touchMin=-1/0,E.edge=.25*E.contentWidth,0===E.gallery.index&&(E.touchMax=0),E.gallery.index===E.gallery.total&&(E.touchMin=0),E.$boxer.on("touchmove.boxer",x).one("touchend.boxer",y)}}function x(a){var b="undefined"!=typeof a.originalEvent.targetTouches?a.originalEvent.targetTouches[0]:null;E.delta=E.xStart-(b?b.pageX:a.clientX),E.delta>20&&C(a),E.canSwipe=!0;var c=-E.delta;c<E.touchMin&&(c=E.touchMin,E.canSwipe=!1),c>E.touchMax&&(c=E.touchMax,E.canSwipe=!1),E.$image.css({transform:"translate3D("+c+"px,0,0)"}),E.touchTimer=z(E.touchTimer,300,function(){y(a)})}function y(a){C(a),A(E.touchTimer),E.$boxer.off("touchmove.boxer touchend.boxer"),E.delta&&(E.$boxer.addClass("animated"),E.swipe=!1,E.canSwipe&&(E.delta>E.edge||E.delta<-E.edge)?(E.swipe=!0,E.delta<=E.leftPosition?E.$image.css({transform:"translate3D("+E.contentWidth+"px,0,0)"}):E.$image.css({transform:"translate3D("+-E.contentWidth+"px,0,0)"})):E.$image.css({transform:"translate3D(0,0,0)"}),E.swipe&&E.$arrows.filter(E.delta<=E.leftPosition?".previous":".next").trigger("click"),z(E.resetTimer,E.options.duration,function(){E.$boxer.removeClass("animated")}))}function z(a,b,c){return A(a),setTimeout(c,b)}function A(a){a&&(clearTimeout(a),a=null)}function B(a){var b=a[0],c=new Image;return"undefined"!=typeof b.naturalHeight?{naturalHeight:b.naturalHeight,naturalWidth:b.naturalWidth}:"img"===b.tagName.toLowerCase()?(c.src=b.src,{naturalHeight:c.height,naturalWidth:c.width}):!1}function C(a){a.preventDefault&&(a.stopPropagation(),a.preventDefault())}var D={callback:a.noop,customClass:"",duration:250,fixed:!1,formatter:a.noop,height:100,labels:{close:"Close",count:"of",next:"Next",previous:"Previous"},margin:100,minHeight:100,minWidth:100,mobile:!1,opacity:.75,retina:!1,requestKey:"boxer",top:0,videoRatio:9/16,videoWidth:600,width:100},E={},F=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(b.navigator.userAgent||b.navigator.vendor||b.opera),G={defaults:function(b){return D=a.extend(D,b||{}),a(this)},destroy:function(){return g(),a(this).off(".boxer")},resize:function(){return"undefined"!=typeof E.$boxer&&("element"===E.type?v(E.$content.find(">:first-child")):"image"===E.type?l(0):"video"===E.type&&n(),f()),a(this)}};a.fn.boxer=function(a){return G[a]?G[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?this:c.apply(this,arguments)},a.boxer=function(c,e){return G[c]?G[c].apply(b,Array.prototype.slice.call(arguments,1)):d(a.Event("click",{data:a.extend({$object:c},D,e||{})}))}}(jQuery,window);